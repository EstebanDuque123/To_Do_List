<!-- templates/tareas/lista_tareas.html -->
{% extends 'base.html' %}

{% block content %}
  <div class="container mt-5">
    <h2>Mis Tareas</h2>

    <a href="{% url 'crear_tarea' %}" class="btn btn-primary mb-3">â• Nueva tarea</a>
<!-- ğŸ”¹ Filtros con badges -->
<div class="d-flex gap-2 mb-3">
  <a href="?filtro=todas" class="btn btn-outline-primary d-flex align-items-center {% if filtro == 'todas' %}active{% endif %}">
    ğŸ“‹ Todas 
    <span class="badge bg-primary ms-2">{{ total_tareas }}</span>
  </a>
  <a href="?filtro=pendientes" class="btn btn-outline-warning d-flex align-items-center {% if filtro == 'pendientes' %}active{% endif %}">
    â³ Pendientes 
    <span class="badge bg-warning text-dark ms-2">{{ pendientes_count }}</span>
  </a>
  <a href="?filtro=completadas" class="btn btn-outline-success d-flex align-items-center {% if filtro == 'completadas' %}active{% endif %}">
    âœ… Completadas 
    <span class="badge bg-success ms-2">{{ completadas_count }}</span>
  </a>
</div>

    <ul class="list-group">
      {% for tarea in tareas %}
        <li class="list-group-item d-flex justify-content-between align-items-start">
          
          <div class="flex-grow-1">
            <span {% if tarea.completada %} style="text-decoration: line-through;" {% endif %}>
              <strong>{{ tarea.titulo }}</strong> â€“ {{ tarea.categoria }}
            </span>

            {% if tarea.descripcion %}
              <p class="text-muted mb-1">{{ tarea.descripcion }}</p>
            {% endif %}
            
             <!-- Fechas -->
            <small class="text-muted">
              ğŸ“… Creada: {{ tarea.fecha_creacion|date:"d/m/Y h:i A" }}
              {% if tarea.fecha_completado %}
                | âœ… Finalizada: {{ tarea.fecha_completado|date:"d/m/Y h:i A" }}
              {% endif %}
            </small>
          </div>

          <div class="d-flex flex-column gap-1">
            <a href="{% url 'editar_tarea' tarea.id %}" class="btn btn-warning btn-sm">âœï¸ Editar</a>
            <a href="{% url 'eliminar_tarea' tarea.id %}" class="btn btn-danger btn-sm">ğŸ—‘ï¸ Eliminar</a>

            {% if not tarea.completada %}
              <a href="{% url 'completar_tarea' tarea.id %}" class="btn btn-success btn-sm">âœ… Completar</a>
            {% endif %}
          </div>
        </li>
      {% empty %}
        <li class="list-group-item">No tienes tareas aÃºn.</li>
      {% endfor %}
    </ul>
  </div>
{% endblock %}
